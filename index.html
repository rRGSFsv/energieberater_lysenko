<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Service Selection</title>
<style>

*{
margin:0;
box-sizing:border-box;
font-family:Arial,sans-serif;
}

body{
background:#151912;
color:#FFF6F7;
line-height:1.5;
overflow-x:hidden;
}

header{
display:flex;
justify-content:flex-start;
align-items:center;
padding:1rem 2rem;
background:#10120f;
position:fixed;width:100%;
top:0;z-index:100;
}

header button{
background:none;
border:none;
color:#FFF6F7;
font-size:1.5rem;
cursor:pointer;
}

main{
display:flex;
flex-direction:column;
align-items:center;
padding-top:80px;
}

.section{
width:100%;
min-height:30vh;
display:flex;
justify-content:center;
align-items:center;
flex-direction:column;
text-align:center;
padding:2rem;
}


.services {      
  flex-direction:column;
  gap:1rem;
  justify-content:center;
  align-items:center;
  margin-top: 30px;
}

.service-btn{
background:#28a745;
color:#FFF6F7;
border:none;
padding:1.2rem 1rem;
font-size:1rem;
cursor:pointer;
border-radius:8px;
position:relative;
z-index:10;
}

.service-btn:hover{
background:#28a745;
color:#FFF6F7;
}

.form-container{
display:flex;
flex-direction:column;
background:#202420;
padding:2rem;
border-radius:12px;
max-width:400px;
width:90%;
margin-top:2rem;
opacity:0;
transform:translateY(20px);
pointer-events:none;
transition:opacity 0.6s ease,transform 0.6s ease;
position:relative;z-index:10;
}

.form-container.active{opacity:1;transform:translateY(0);pointer-events:auto;}
.form-container input,.form-container select,.form-container textarea{width:100%;padding:0.8rem;margin-bottom:1rem;border:none;border-radius:6px;font-size:1rem;background:#111310;color:#fff;}

.form-container label{
color:#cfcfcf;
font-size:0.9rem;
margin-bottom:0.2rem;
display:block;
margin-bottom: 15px;
}

.form-container button{background:#28a745;color:#FFF6F7;border:none;padding:1rem;border-radius:6px;cursor:pointer;font-size:1rem;}
.form-container button:hover{background:#28a745;color:#FFF6F7;}
.thankyou{display:none;margin-top:1rem;color:rgb(160,255,255);}
.info{margin-top:4rem;max-width:800px;text-align:center;color:#cfcfcf;}

@media(max-width:600px){
  .services{flex-direction:column;gap:0.8rem;}
  .service-btn{}
}

.input-row {
  align-items:center;
  gap:10px;
  margin-bottom:15px;
}

.input-row img {
  width:24px;
  height:24px;
  opacity:0.9;
  margin-top: 20px;
}

.input-mini {
  width:80px !important;
  padding:0.6rem !important;
  text-align:center;
}

.input-unit {
  color:#cfcfcf;
  font-size:0.9rem;
}


.energy-buttons{display:flex;gap:1rem;margin:1rem 0;justify-content:center;}
.energy-buttons button{flex:1;padding:0.8rem;font-size:1rem;border-radius:6px;border:none;background:#28a745;color:#FFF6F7;cursor:pointer;}
.energy-buttons button.active{background:#FFF6F7;color:#28a745;}

.energy-section{display:none;margin-bottom:1rem;}

canvas#neuro{
position: fixed;
top: 0; left: 0;
width: 100%; height: 100%;
pointer-events: none;
z-index: -1;
}
</style>
</head>

<body>

<header>
  <button onclick="scrollToTop()">HOME</button>
</header>

<canvas id="neuro"></canvas>

<main>
<section class="section hero">
  <h1>Wähle eine Dienstleistung</h1>

  <div class="services">
    <button class="service-btn" data-service="Vertrag wechseln">Vertrag wechseln</button>
    <button class="service-btn" data-service="Umzug">Umzug</button>
    <button class="service-btn" data-service="Neueinzug">Neueinzug</button>
  </div>

</section>

<section class="section form-section">
<div class="form-container" id="serviceForm">
  <h2 id="formTitle">Dienstleistung auswählen</h2>

  <!-- Strom/Gas buttons -->
  <div class="energy-buttons" id="energyButtons" style="display:none;">
    <button type="button" data-energy="Strom">Strom</button>
    <button type="button" data-energy="Gas">Gas</button>
  </div>

  <form id="contactForm" action="https://api.web3forms.com/submit" method="POST">

    <!-- Universal Bewohner -->
    <div class="universal-section" id="universalSection" style="display:none;">
      <label>Zahl von Bewohner:</label>
      <div class="input-row">
        <img src="person.svg">
        <input type="number" class="input-mini" name="universalBewohner" min="1" max="10" value="1">
      </div>
    </div>

    <!-- Strom Section -->
    <div class="energy-section" id="stromSection">
      <label>Zahl von Bewohner (Strom):</label>
      <div class="input-row">
        <img src="person.svg">
        <input type="number" class="input-mini" name="stromBewohner" min="1" max="10" value="1">
      </div>

      <label>Verbrauch (Strom):</label>
      <div class="input-row">
        <input type="number" class="input-mini" name="stromVerbrauch" min="500" max="30000" step="100" value="2000">
        <span class="input-unit">kWh/Jahr</span>
      </div>
    </div>

    <!-- Gas Section -->
    <div class="energy-section" id="gasSection">
      <label>Zahl von Bewohner (Gas):</label>
      <div class="input-row">
        <img src="person.svg">
        <input type="number" class="input-mini" name="gasBewohner" min="1" max="10" value="1">
      </div>

      <label>Verbrauch (Gas):</label>
      <div class="input-row">
        <input type="number" class="input-mini" name="gasVerbrauch" min="500" max="30000" step="100" value="2000">
        <span class="input-unit">kWh/Jahr</span>
      </div>
    </div>

    <input type="hidden" name="access_key" value="03e1eca5-ec17-42d5-9603-e65f251920d3">
    <input type="text" name="name" placeholder="Dein Name" required>
    <input type="email" name="email" placeholder="Deine E-Mail" required>
    <input type="text" name="phone" placeholder="Telefon / WhatsApp" required>

    <label for="contact_method">Bevorzugte Kontaktmethode:</label>
    <select name="contact_method" id="contact_method" required>
      <option value="WhatsApp">WhatsApp</option>
      <option value="Telephonisch">Telephonisch</option>
      <option value="Email">per Email</option>
    </select>

    <label for="language">Sprache / Language:</label>
    <select name="language" id="language" required>
      <option value="Deutsch">Deutsch</option>
      <option value="English">English</option>
      <option value="Українська">Українська</option>
      <option value="Русский">Русский</option>
    </select>

    <input type="hidden" name="service" id="selectedService" value="">
    <button type="submit">Absenden</button>
  </form>

  <div class="thankyou" id="thankyouMsg">Danke! Wir werden uns bald bei dir melden.</div>
  <div class="thankyou" id="errorMsg" style="display:none; color:#ff8b8b;">Fehler beim Senden. Bitte versuche es erneut.</div>

</div>
</section>

<section class="section info">
  <h2>Über Uns</h2>
  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
</section>
</main>


<!-- SHADERS -->
<script type="x-shader/x-vertex" id="vertShader">
precision mediump float;
attribute vec2 a_position;
varying vec2 vUv;
void main(){ vUv = .5*(a_position+1.0); gl_Position = vec4(a_position,0.0,1.0);}
</script>

<script type="x-shader/x-fragment" id="fragShader">
precision mediump float;
varying vec2 vUv;
uniform float u_time;
uniform vec2 u_pointer_position;
uniform float u_ratio;
vec2 rotate(vec2 uv,float th){return mat2(cos(th),sin(th),-sin(th),cos(th))*uv;}
float neuro_shape(vec2 uv,float t,float p){
vec2 sine_acc=vec2(0.0);
vec2 res=vec2(0.0);
float scale=8.0;
for(int j=0;j<15;j++){
uv=rotate(uv,1.0);
sine_acc=rotate(sine_acc,1.0);
vec2 layer=uv*scale+float(j)+sine_acc-t;
sine_acc+=sin(layer)+2.4*p;
res+=(0.5+0.5*cos(layer))/scale;
scale*=1.2;}
return res.x+res.y;
}
void main(){
vec2 uv=0.5*vUv;
uv.x*=u_ratio;
vec2 pointer=vUv-u_pointer_position;
pointer.x*=u_ratio;
float p=clamp(length(pointer),0.0,1.0);
p=0.5*pow(1.0-p,2.0);
float t=0.001*u_time;
vec3 color=vec3(0.0,0.5,0.2);
float noise=neuro_shape(uv,t,p);
noise=1.2*pow(noise,3.0);
noise+=pow(noise,10.0);
noise=max(0.0,noise-0.5);
noise*=(1.0-length(vUv-0.5));
color=color*noise;
gl_FragColor=vec4(color,1.0);
}
</script>

<script>
/* ---- WebGL background ---- */
const canvasEl=document.getElementById("neuro");
const gl=canvasEl.getContext("webgl")||canvasEl.getContext("experimental-webgl");
let uniforms={},pointer={x:0,y:0,tX:0,tY:0},devicePixelRatio=Math.min(window.devicePixelRatio,2);

function initShader(){
  const vs=document.getElementById("vertShader").textContent;
  const fs=document.getElementById("fragShader").textContent;
  function sh(src,t){let s=gl.createShader(t);gl.shaderSource(s,src);gl.compileShader(s);return s;}
  let v=sh(vs,gl.VERTEX_SHADER), f=sh(fs,gl.FRAGMENT_SHADER);
  let p=gl.createProgram(); gl.attachShader(p,v); gl.attachShader(p,f); gl.linkProgram(p); gl.useProgram(p);
  let vb=gl.createBuffer(); gl.bindBuffer(gl.ARRAY_BUFFER,vb);
  gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),gl.STATIC_DRAW);
  let pos=gl.getAttribLocation(p,"a_position");
  gl.enableVertexAttribArray(pos); gl.vertexAttribPointer(pos,2,gl.FLOAT,false,0,0);
  ["u_time","u_ratio","u_pointer_position"].forEach(n=>uniforms[n]=gl.getUniformLocation(p,n));
}
initShader();

function resizeCanvas(){
  canvasEl.width=window.innerWidth*devicePixelRatio;
  canvasEl.height=window.innerHeight*devicePixelRatio;
  gl.viewport(0,0,canvasEl.width,canvasEl.height);
  gl.uniform1f(uniforms.u_ratio,canvasEl.width/canvasEl.height);
}
resizeCanvas();
window.addEventListener("resize",resizeCanvas);

window.addEventListener("pointermove",e=>{
pointer.tX=e.clientX;
pointer.tY=e.clientY;
});

function render(){
pointer.x+=(pointer.tX-pointer.x)*0.2;
pointer.y+=(pointer.tY-pointer.y)*0.2;
gl.uniform1f(uniforms.u_time,performance.now());
gl.uniform2f(uniforms.u_pointer_position,pointer.x/window.innerWidth,1-pointer.y/window.innerHeight);
gl.drawArrays(gl.TRIANGLE_STRIP,0,4);
requestAnimationFrame(render);
}
render();

/* ---- UI logic ---- */

const serviceBtns=document.querySelectorAll('.service-btn');
const formContainer=document.getElementById('serviceForm');
const formTitle=document.getElementById('formTitle');
const selectedServiceInput=document.getElementById('selectedService');

const energyButtonsWrapper=document.getElementById('energyButtons');
const energyButtons=document.querySelectorAll('#energyButtons button');

const universalSection=document.getElementById('universalSection');
const stromSection=document.getElementById('stromSection');
const gasSection=document.getElementById('gasSection');

function resetEnergySections(){
  stromSection.style.display="none";
  gasSection.style.display="none";
  energyButtons.forEach(b=>b.classList.remove('active'));
}

serviceBtns.forEach(btn=>{
  btn.addEventListener('click',()=>{
    const service=btn.dataset.service;
    formTitle.textContent=`Du hast "${service}" gewählt`;
    selectedServiceInput.value=service;
    resetEnergySections();

    if(service==="Vertrag wechseln"){
      universalSection.style.display="none";
      energyButtonsWrapper.style.display="flex";
    } else {
      energyButtonsWrapper.style.display="none";
      universalSection.style.display="block";
    }

    formContainer.classList.add('active');
    formContainer.scrollIntoView({behavior:'smooth'});
  });
});

energyButtons.forEach(btn=>{
  btn.addEventListener('click',()=>{
    resetEnergySections();
    btn.classList.add('active');

    if(btn.dataset.energy==="Strom"){
      stromSection.style.display="block";
    } else {
      gasSection.style.display="block";
    }
  });
});

const contactForm=document.getElementById('contactForm');
const thankyouMsg=document.getElementById('thankyouMsg');
const errorMsg=document.getElementById('errorMsg');

contactForm.addEventListener('submit',async e=>{
  e.preventDefault();
  thankyouMsg.style.display='none';
  errorMsg.style.display='none';

  const formData=new FormData(contactForm);

  try{
    const res=await fetch(contactForm.action,{method:'POST',body:formData});
    const json=await res.json();

    if(res.ok && json.success){
      contactForm.reset();
      resetEnergySections();
      universalSection.style.display="none";
      thankyouMsg.style.display='block';
    } else {
      errorMsg.style.display='block';
    }
  }
  catch(err){
    errorMsg.style.display='block';
  }
});

function scrollToTop(){
  window.scrollTo({top:0,behavior:'smooth'});
}
</script>

</body>
</html>
